<h1>Разбор задач летнего отбора в параллель A Яндекс Кружка</h1><br>Автор статьи: tiom4eg

<h2>Задача A'-A 1</h2>
<details>
  <summary>Подсказка 1</summary>

  Давайте вспомним про выпуклые оболочки. Как они могут помочь при решении этой задачи?
  
</details>
<details>
  <summary>Полное решение</summary>

  Определения и обозначения:

  Многоугольник из условия будем обозначать как $P$.
  
  Пусть есть множество точек $S$, лежащих на одной прямой $l$.
  *Крайней* будем называть такую $p \in S$, что все точки в $S \setminus p$ лежат по одну сторону от перпендикуляра к $l$, проведённого через $p$.
  
  <br>
  
  Решение:

  Эту задачу наверняка можно было решать несколькими способами, но здесь рассмотрим конкретно моё решение.

  Для начала заметим, что если для какой-то прямой $l$, содержащей две точки $P$, все точки $P$ находятся в одной полуплоскости, то $l$ будет содержать в себе какую-то сторону выпуклой оболочки $P$.
  Могут быть случаи, когда на $l$ лежит больше двух вершин $P$, однако тогда в выпуклую оболочку будут входить только две *крайние* вершины $P$ из множества тех, что лежат на $l$.
  В таком случае, если для каких-то двух вершин, лежащих на $l$, проекция центра масс будет лежать на отрезке между ними, то она точно будет лежать на отрезке между двумя *крайними* для этой прямой вершинами.

  Значит, для решения задачи нам достаточно построить выпуклую оболочку $P$ и посчитать количество соседних пар вершин в ней, для которых выполняется условие.
  
</details>

<h2>Задача A'-A 2</h2>
<details>
  <summary>Подсказка 0</summary>

  Это не задача на структуры данных.
  
</details>
<details>
  <summary>Подсказка 1</summary>

  Пусть $(l, r)$ - это такое состояние в задаче, что последней посещённой вершиной на левом берегу была $l$, а на правом $r$. 
  По условию из $(l, r)$ можно перейти только в $(x, r)$ и $(l, y)$, где $l \lt x$ и $r \lt y$, следовательно, граф состояний ацикличен.
  
</details>
<details>
  <summary>Полное решение</summary>

  Определения и обозначения:

  $(l, r)$ - это такое состояние в задаче, что последней посещённой вершиной на левом берегу была $l$, а на правом $r$. 
  
  $g_i$ - отсортированный список вершин, в которые ведут рёбра из вершины $i$.
  
  <br>
  
  Решение:

  Как было сказано в подсказке 1, если рассматривать граф состояний в данной задаче, то он будет ацикличным. Вспоминаем, что на ацикличных графах можно подсчитывать динамику с мемоизацией.

  Пусть мы находимся в состоянии $(l, r)$, причём сейчас мы стоим в вершине $l$ левого берега (для вершины $r$ правого берега аналогично). 
  Тогда можно заметить, что текущее состояние можно пересчитать через все состояния $(l, x)$, где $x \in g_l$ и $x \gt r$.

  Далее можно заметить, что для вершины $l$ левого берега достаточно сосчитать только такие состояния $(l, x)$, что $x \in g_l$, а для всех оставшихся $x$ соответствующее состояние находится `lower_bound`-ом по $g_l$.
  Значит, всего состояний динамики будет $O(p)$, а её пересчёт займет $O(p \cdot log (n + m))$.
  
</details>

<h2>Задача A'-A 3</h2>
<details>
  <summary>Подсказка 0</summary>

  Эта задача решается без техники разделяй-и-властвуй.
  
</details>
<details>
  <summary>Подсказка 1</summary>

  Стоимость отрезков с общей границей можно поддерживать при помощи стека минимумов и максимумов.
  
</details>
<details>
  <summary>Полное решение</summary>

  Определения и обозначения:

  $cost(l, r)$ - красота подотрезка $[l; r]$.

  $dp_i$ - сумма привлекательностей всех разбиений префикса $[0; i]$ на подотрезки.
  
  <br>
  
  Решение:

  Заметим, что $$dp_i = \sum_{j=0}^{i - 1} dp_j \cdot cost(j + 1, i)$%

  Будем поддерживать стек минимумов и максимумов, причём помимо самих значений будем также хранить сумму значений динамики на отрезке от первой до последней позиции с соответствующим минимумом/максимумом. 
  При добавлении нового элемента (подсчет $dp_i$ через предыдущие значения) достаточно будет обновить стек минимумов/максимумов.

  Получаем амортизированное $O(n)$.
  
</details>
